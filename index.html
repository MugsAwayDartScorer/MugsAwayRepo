<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mugs Away Dart Scoring App</title>
  <link rel="stylesheet" href="style.css">
  <style>
    /* Force dartboard images to 50% larger */
    .title-img { width: 75px; height: auto; }
    /* Indent menu-description further right */
    .menu-description { margin-left: 28ch; }
    .menu-description dt font { color: #4FC3F7; }

    /* Download + Donate styling */
    #download-donate { margin-bottom: 0; }
    #downloadBtn, #donateBtn, #subscribeForm button { margin-top: 10px; }
    #downloadCount, #subscriberCount { margin-top: 5px; font-weight: bold; color: #FFFFFF; }
  </style>
</head>
<body>

<!-- HEADER -->
<header class="title-container">
  <img src="assets/dartboardnormal.png" alt="Dartboard Left" class="title-img">
  <div class="title-text">
    <h1>Mugs Away</h1>
    <h2>Dart Scoring App</h2>
  </div>
  <img src="assets/dartboardnormal.png" alt="Dartboard Right" class="title-img">
</header>

<!-- INTRO TEXT -->
<section class="intro">
  <p>Play 101, 301, 501, 701 and 1001 with a friend or against the Bot!</p>
  <p>No fuss, straightforward scoring app for dart players.</p>
</section>

<!-- DOWNLOAD + DONATE BUTTONS -->
<section id="download-donate">
  <div class="btn-container">
    <a href="assets/MugsAwayWindows.zip" download>
      <button id="downloadBtn">Download Windows App Free!</button>
    </a>
    <a href="https://paypal.me/MugsAwayDarts" target="_blank">
      <button id="donateBtn">Buy Me a Beer!</button>
    </a>
    <p id="downloadCount">Downloads: 0</p>
    <p id="subscriberCount">Subscribers: 0</p>
  </div>
</section>

<!-- GAME MODES / SCREENSHOTS -->
<section id="screenshots">
  <p>Screenshots from Android version (Coming Soon)</p>

  <div class="mode">
    <h3>501 Continuous Mode (default)</h3>
    <img src="assets/Main.png" alt="501 Continuous Mode Screenshot" class="mode-img" style="width:450px;height:999px;">
  </div>

  <div class="mode">
    <h3>101 Best of 3 Sets</h3>
    <img src="assets/101 Best of.jpg" alt="101 Best of 3 Sets Screenshot" class="mode-img" style="width:450px;height:999px;">
  </div>

  <div class="menu-image">
    <p><strong>Easy Menu for all modes</strong></p>
    <img src="assets/Menu black.png" alt="Menu Screenshot" class="menu-img" width="866" height="491">
    <dl class="menu-description">
      <dt><font>Game Type:</font></dt><dd>101, 301, 501, 701, 1001</dd>
      <dt><font>Match Format:</font></dt>
      <dd>
        Continuous Play (default)<br>
        Best 1 Set (3 Legs)<br>
        Best 3 Sets (3 Legs)<br>
        Best 5 Sets (3 Legs)<br>
        First 5 Legs<br>
        First 7 Legs<br>
        Customize... Create your own match, Choose number of Sets/Legs
      </dd>
      <dt><font>Throwing Rule:</font></dt><dd>Alternative throw/Mugs Away (loser of previous leg throws first)</dd>
      <dt><font>Toggle Bot:</font></dt><dd>Enable / Disable Bot</dd>
      <dt><font>Favourites:</font></dt><dd>Save and load games</dd>
      <dt><font>End Game/Stats:</font></dt><dd>Shows Statistics Screen</dd>
      <dt><font>About:</font></dt><dd>Displays version number and Contact details</dd>
    </dl>
  </div>
</section>

<!-- USER REVIEWS -->
<section id="reviews">
  <h2 class="section-title">User Reviews</h2>
  <div id="reviewList"></div>

  <form id="reviewForm" class="form-section">
    <h3>Submit Your Review</h3>
    <input id="name" type="text" placeholder="Your Name" required size="20">
    <select id="rating" required>
      <option value="">Rating</option>
      <option value="1">&#9733;</option>
      <option value="2">&#9733;&#9733;</option>
      <option value="3">&#9733;&#9733;&#9733;</option>
      <option value="4">&#9733;&#9733;&#9733;&#9733;</option>
      <option value="5">&#9733;&#9733;&#9733;&#9733;&#9733;</option>
    </select>
    <textarea id="comment" rows="3" placeholder="Your review" required cols="20"></textarea>
    <button type="submit">Submit Review</button>
  </form>
</section>

<!-- SUBSCRIBE SECTION -->
<section id="subscribe">
  <h2 class="section-title">Get Android Release Updates</h2>
  <form id="subscribeForm" class="form-section">
    <input id="email" type="email" placeholder="Enter your email" required size="20">
    <button type="submit">Subscribe</button>
  </form>
</section>

<!-- MANUAL -->
<section id="manual">
  <h2 class="section-title">Manual</h2>
  <p><a href="assets/manual.pdf" target="_blank">Download Manual (PDF)</a></p>
</section>

<!-- FOOTER -->
<footer>
  <p>© 2025 Mugs Away Dart Scoring App</p>
  <p><em>Android version coming soon!</em></p>
</footer>

<!-- Firebase + App Script -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, query, orderBy, doc, getDoc, updateDoc, increment, setDoc } from "https://www.gstatic.com/firebasejs/10.6.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB8TNP-UxQOM6_uIfMn2BU_tfXj9M-Y9JY",
    authDomain: "mugsawayreviews.firebaseapp.com",
    projectId: "mugsawayreviews",
    storageBucket: "mugsawayreviews.firebasestorage.app",
    messagingSenderId: "546187997609",
    appId: "1:546187997609:web:2c97076d266865ffbd94b8",
    measurementId: "G-5WNR8SMPZB"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const reviewForm = document.getElementById("reviewForm");
  const reviewList = document.getElementById("reviewList");
  const downloadBtn = document.getElementById("downloadBtn");
  const downloadCountEl = document.getElementById("downloadCount");
  const subscribeForm = document.getElementById("subscribeForm");
  const subscriberCountEl = document.getElementById("subscriberCount");

  // Load reviews
  async function loadReviews() {
    reviewList.innerHTML = "";
    const q = query(collection(db, "reviews"), orderBy("timestamp", "desc"));
    const snapshot = await getDocs(q);
    snapshot.forEach(docSnap => {
      const data = docSnap.data();
      const div = document.createElement("div");
      div.className = "review";
      div.innerHTML = `<strong>${data.name}</strong> (${ '★'.repeat(data.rating) }${ '☆'.repeat(5-data.rating) })<br><p>${data.comment}</p>`;
      reviewList.appendChild(div);
    });
  }
  loadReviews();

  reviewForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("name").value.trim();
    const rating = document.getElementById("rating").value;
    const comment = document.getElementById("comment").value.trim();
    if (!name || !rating || !comment) return;
    await addDoc(collection(db, "reviews"), { name, rating: parseInt(rating), comment, timestamp: new Date() });
    reviewForm.reset();
    loadReviews();
  });

  // Download counter
  const downloadDoc = doc(db, "counters", "downloads");
  async function initDownloadCounter() {
    const docSnap = await getDoc(downloadDoc);
    if (!docSnap.exists()) await setDoc(downloadDoc, { count: 0 });
    updateDownloadDisplay();
  }
  async function updateDownloadDisplay() {
    const docSnap = await getDoc(downloadDoc);
    downloadCountEl.textContent = `Downloads: ${docSnap.exists() ? docSnap.data().count : 0}`;
  }
  downloadBtn.addEventListener("click", async () => {
    await updateDoc(downloadDoc, { count: increment(1) });
    updateDownloadDisplay();
  });
  initDownloadCounter();

  // Subscriber counter
  const subscribersCol = collection(db, "subscribers");
  async function updateSubscriberDisplay() {
    const snapshot = await getDocs(subscribersCol);
    subscriberCountEl.textContent = `Subscribers: ${snapshot.size}`;
  }
  updateSubscriberDisplay();

  subscribeForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("email").value.trim();
    if (!email) return;
    await addDoc(subscribersCol, { email, timestamp: new Date() });
    subscribeForm.reset();
    updateSubscriberDisplay();
    alert("Subscribed successfully!");
  });
</script>

</body>
</html>
